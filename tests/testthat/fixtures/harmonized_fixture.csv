# harmonized_fixture.csv (full schema, minimal rows)
# Purpose: surface schema drift & exercise parsing (coords, dates, numeric, NA). Keep row count low.
# Rows: 4 real samples + 1 kit blank (NA Parent.ID, blank DNA yield to force NA coercion).
# Regenerate (example): df <- read.csv('Data/harmonized.csv'); keep <- df[df$Parent.ID %in% c('NW_FE_00B','NW_FE_003','NW_FE_004','NW_FE_005') | is.na(df$Parent.ID),]; write.csv(keep,'tests/testthat/fixtures/harmonized_fixture.csv',row.names=FALSE)
# Note: Comments ignored via comment.char="#" in tests.
"Parent.ID","Extraction...PNNL.Quick.Reference","Date.of.Extraction","Date.of.Sampling","Time.in.Freezer..Days.","DNA.Extraction.Kit.Used","Lab.ID.Used.During.Extraction..label.on.tube..sometimes.different.from.BF...","Owen.s.Notation.for.sequencing","Filter.Portion.Details","Full.filtration.Details","Filter.Used.for.Extraction","Total.volume.filtered.through.whole.filter..L.","X..Of.Whole.Filter.Used","Weight.of.whole.filter","Weight.of.filter.fraction.used..mg.","Filtered.Volume.Used.in.extraction.L.","DNA.Yield..ng.µl.","DNA.Yield..µg.µl.","X260...280","X260...230","Elution.Volume..µl.","Sample.Volume.Used..µl.","Remaining.Volume","Total.µg","Total.ng","ng.normalized.per.ml.of.filtered.volume","Qubit.Kit.used","Actual.Nucleic..Acid.Conc...ng.ul.","Total..Amount...ng.","Total..Amount...µg.","ng.per.mL.of.filtered.volume.2","Date.Shipped.for.Sequencing","Azenta.ID","Sample.Volume","Actual.nucleic.acid.conc...ng.µL.","A260.A280","A260.A230","Actual..Nucleic..Acid..Conc....ng.ul.2","Total..Amount...ng.3","X.Reads","Yield..Mbases.","Mean.quality.score","X..Bases...30","DNA.Yield..ng.µl.4","X260...280.5","X260...2306","Total.nanograms","Post.Extraction.Kit.Used","DNA.ID.s.combined","DNA.Yield..ng.µl.7","DNA.Yield..µg.µl.8","X260...280.9","X260...23010","Elution.Volume..µl..11","Sample.Volume.Used..µl.12","Remaining.Volume.13","Total.µg14","Total.ng15","Qubit.Kit.used16","Actual..Nucleic..Acid..Conc....ng.ul.17","Total..Amount...ng.18","Total..Amount...µg.19","Filter.Used.for.Extraction.Fixed_Name","Experiment.index..Parent.Sample.unique.ids.used.for.DMP.","Subsample.Filter...for.Quick.Reference","Replicate..","Filter.Pore.Size","Filter.Diameter","Filter.material","Filtration.Sequence","Filter.Fraction2","Filtration.Equipment","Person.Filtering","Time.of.Filter.Subsample..Collection..When.filter.is.done.filtering.","Date.filtered","Date.of.Sample.Collection","Time.between.sampling.and.filtration..days.","Sample.Location","Time.of.parent.sample.collection","Sampling.Method...At.initial.time.of.water.collection.","Total.Sample.Volume.Collected..L.","Volume.Filtered.through.individual.filter..L.","Filtrate.kept.","DNA.extracted.","X..of.Filter.destructively.sampled.if.DNA.extracted","Sequenced..x","DNA.Sample.ID.s.","Additional.Notes","Date","Sampling.Time","Year","Month","Day","Hour","Min","Tidal.Stage","Site.Coordinates","Latitude","Longitude","Crew","Sampling.Method","Volume.Collected...L.","Secchi.Depth..m....Secchi.Disk.","Time.of.Secchi.measurement..Sechhi.Disk.","Cloud.Cover..Observation.","Sea.State....Observation.","Wind.speed...Gust..m.s.....Hand.held.Anemometer.","Air.Temp...C....Hand.held.Anemometer.","Water.temperature...C.....YSI.Sensor.","Dissolved.Oxygen..mg.L....YSI.Sensor.","Salinity..ppt....YSI.Sensor.","Turbidity.......YSI.Sensor.","pH...YSI.Sensor.","Chlorophyll........YSI.Sensor.","P.E.........YSI.Sensor.","water_level..m..NAVD88....Sequim.Dock.Data.","temp..degC...Sequim.Dock.Data.","do..mg.L...Sequim.Dock.Data.","salinity..ppt...Sequim.Dock.Data.","airtemp_avg..degC...Sequim.Dock.Data.","baro_pressure..Pa...Sequim.Dock.Data.","rh......Sequim.Dock.Data.","rain..mm...Sequim.Dock.Data.","winddir..deg.from...Sequim.Dock.Data.","windspeed_avg..m.s...Sequim.Dock.Data.","windspeed_max..m.s...Sequim.Dock.Data.","land.par_avg..Sequim.Dock.Data.","underwater.lower_par..Sequim.Dock.Data.","underwater.upper_par..Sequim.Dock.Data.","chlorophyll..Sequim.Dock.Data.","phycoerythrin..ppb...Sequim.Dock.Data.","cdom..ppb...Sequim.Dock.Data.","pco2_water..Sequim.Dock.Data.","pco2_air..Sequim.Dock.Data.","o2_water..Sequim.Dock.Data.","o2_air","pH..Sequim.Dock.Data.","Environment.Notes..observation.","Processing.Notes","X..of.Macro.filters.produced","X..of.Micro.filters.produced","X..of.PIco.filters.produced","X..of.viral.filters.produced","DNA.Extracted.from.Filters.","Sequenced..y","TargetSequencingDepth","Grouping","kappa","C","LR","modelR","LRstar","diversity","No.OfViralCluster","No.OfAssemblies","No.Of10kbupAssemblies","No.OfViralContig","Read.Count","Subset_highest_cyanos","ProSyn_cyanos","Synechococcus","Prochlorococcus","Subset_highest_synphage","Subset_highest_prophage","Subset_highest_phages","Dictyostelium.discoideum","X20241018_cyano_all_genomes","X20241018_pro_all_genomes","X20241018_syn_all_genomes","X20241021_cyanophage_all_genomes","X20241021_proc_phage_all_genomes","X20241021_syn_phage_all_genomes","amoeba_genome_5_all","Subset_highest_cyanos_rpm","ProSyn_cyanos_rpm","Synechococcus_rpm","Prochlorococcus_rpm","Subset_highest_synphage_rpm","Subset_highest_prophage_rpm","Subset_highest_phages_rpm","Dictyostelium.discoideum_rpm","X20241018_cyano_all_genomes_rpm","X20241018_pro_all_genomes_rpm","X20241018_syn_all_genomes_rpm","X20241021_cyanophage_all_genomes_rpm","X20241021_proc_phage_all_genomes_rpm","X20241021_syn_phage_all_genomes_rpm","amoeba_genome_5_all_rpm"
"NW_FE_00B","#014b",2024-01-02,2023-12-19,14,"Qiagen Dneasy PowerSoil ProKit Ref. 47014 Lot. 175032099","PNNL-NRB1","PNNL-NRB1","Micro (> 5µm) MCE Membrane","NRB 5um filter solids resuspended, 1st vortex, 12/19/23","BF-001",NA,NA,NA,NA,NA,3.4,0.0034,2.49,0.05,50,2,48,0.1632,163.2,NA,NA,NA,NA,NA,NA,2024-01-01,"SGA01183",41,5,1.67,0.07,0.12,4.92,5009787,1503,38.55,92.85,1.6,-0.82,0.02,-158.28,NA,NA,NA,NA,NA,NA,NA,NA,0,0,0,NA,NA,NA,NA,"BF-001","NW_FE_001","BF-001","R1","5µm",NA,"MCE","5µm single filtration","Micro (> 5µm)","Single flask","NRB, SJE",NA,2023-12-19,2023-12-19,0,"PNNL-Sequim Floating Dock",9H 15M 0S,"Surface grab",5,NA,"Yes","Yes",NA,"Yes","PNNL-NRB1",NA,2024-01-02,NA,2024,NA,NA,NA,NA,NA,NA,NA,NA,NA,"Culture biomass pellet",NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1,"NA-NA-NA-NA-NA-NA-NA-NA-Qiagen Dneasy PowerSoil ProKit-1",0.31369,0.346530434,716601450,0.995047867,4.10667e+12,21.62690739,1,90729,49,1,8382508,16006,5146,4448,698,2,0,11,262,42042,14246,23576,1577,958,3260,10502,1909.4523977788,613.897415904643,530.628780789711,83.2686351149322,0.238592077693215,0,1.31225642731268,31.2555621778112,5015.44406518908,1699.49136940877,2812.52341184762,188.1298532611,114.28560521505,388.905086639941,1252.84699996707
"NW_FE_003","#001",2024-03-26,2024-03-12,14,"Qiagen Dneasy PowerSoil ProKit Ref. 47014 Lot. 175032099","PNNL_Dock_1","20240401-PNNL-NRB-Seq1","Micro (> 5µm) MCE Membrane","PNNL Dock, Flood Tide, 03122024, 5µm filter, 4L","BF-004",3.5,1,NA,NA,3.5,4.6,0.0046,1.58,0.15,100,6,94,0.4324,432.4,123.542857142857,NA,1650,155100,155.1,44314.2857142857,2024-04-02,"SGD01246",85,NA,NA,NA,1.46,124.1,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0,0,0,NA,NA,NA,NA,"BF-004","NW_FE_003","BF-004","R1","5µm",NA,"MCE","5µm single filtration","Micro (> 5µm)","Single flask","NRB",NA,2024-03-12,2024-03-12,0,"PNNL-Sequim Floating Dock",15H 30M 0S,"Surface grab",3.5,3.5,"No","Yes",NA,"Yes","20240401-PNNL-NRB-Seq1",NA,2024-03-12,15H 30M 0S,2024,3,12,15,30,"Flood","48°04'45""N 123°02'42""W","48.079340000000002","-123.045097","NRB, KJ","Surface grab",4,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1.778323,8.2073,5.798,30.9065,5.572,1006.592,87.6,0,171.4,1.367,1.666,67.02,3391,7999,0.8228,0.426,0.91,630.5099,436.739363333333,20.025803,21.398221,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA
"NW_FE_004","#004",2024-03-26,2024-03-13,13,"Qiagen Dneasy PowerSoil ProKit Ref. 47014 Lot. 175032099","PNNL_Dock_4","20240401-PNNL-NRB-Seq4","Micro (> 5µm) MCE Membrane","PNNL Dock, Flood Tide, 03132024, 5µm filter, 3.5 L","BF-007",3.5,1,NA,NA,3.5,9.2,0.0092,1.59,0.44,100,6,94,0.8648,864.8,247.085714285714,NA,524,49256,49.256,14073.1428571429,2024-04-02,"SGD01249",86,NA,NA,NA,4.61,396.46,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0,0,0,NA,NA,NA,NA,"BF-007","NW_FE_004","BF-007","R1","5µm",NA,"MCE","5µm single filtration","Micro (> 5µm)","Single flask","NRB",NA,2024-03-13,2024-03-13,0,"PNNL-Sequim Floating Dock",15H 15M 0S,"Surface grab",3.5,3.5,"No","Yes",NA,"Yes","20240401-PNNL-NRB-Seq4",NA,2024-03-13,15H 15M 0S,2024,3,13,15,15,"Flood","48°04'45""N 123°02'42""W","48.079268839568002","-123.045054208037","NRB, KJ","Surface grab",4,4.5,15H 15M 0S,"partially cloudy","mostly calm",NA,NA,NA,NA,NA,NA,NA,NA,NA,1.837073,8.2746,5.751,30.9586,6.538,1029.6,71.58,0,163.7,1.766,2.166,599.3,3594,7999,0.9196,0,3.549,583.007575,431.93265,20.325342,21.593447,NA,"1. light breeze",NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA
"NW_FE_005","#009",2024-04-18,2024-04-15,3,"Qiagen Dneasy PowerSoil ProKit Ref. 47014 Lot. 175032099","11 Q E1","20240418-PNNL-NRB-Seq9","Macro ( > 20µm) Nylon","20µm single filtration, in-line pump, 12.5 L, 1st Elution","BF-011",12.5,0.5,NA,NA,6.25,76.6,0.0766,1.85,1.51,54,4,50,3.83,3830,612.8,NA,500,25000,25,4000,NA,"SGF13081",38,74.6,1.84,1.45,45.4,1725.2,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0,0,0,NA,NA,NA,NA,"BF-011","NW_FE_005","BF-011","R1","20µm",NA,"Nylon","20µm single filtration","Macro ( > 20µm)","In-line pump","NRB",15H 0M 0S,2024-04-15,2024-04-15,0,"PNNL-Sequim Floating Dock",14H 30M 0S,"Pump & in-line filter",0,12.5,"No","Yes",NA,NA,NA,NA,2024-04-15,14H 30M 0S,2024,4,15,14,30,"Ebb","48°04'45""N 123°02'42""W","48.079340000000002","-123.045097","NRB, KJ","Surface grab",12.5,5,14H 35M 0S,"mostly cloudy","cats paws, fairly calm",NA,NA,NA,NA,NA,NA,NA,NA,NA,1.425,NA,NA,NA,9.45,1023.458,62.42,0,353.2,1.213,3.199,505.7,3558,7999,0.52,7.924,0.546,494.47,431.467,20.679,21.496,NA,"1. Incoming tide starting\n2. Secchi hit bottom",NA,NA,NA,NA,NA,NA,NA,10,"Pump & in-line filter -0.5-In-line pump-Nylon Net -20-PNNL Dock-45397-0.604166666666667-Qiagen Dneasy PowerSoil ProKit-10",0.5912,0.618497513,5849338050,0.998851694,5.83415e+12,20.80958857,15,802545,73,16,64208226,139414,45829,11115,34714,32,189,230,2739,173430,49262,32868,4914,5429,9668,80425,2171.27942453978,713.755897881371,173.108660563212,540.647237318159,0.49837850994357,2.94354807435421,3.58209554021941,42.6580855854825,2701.05578060979,767.222567401255,511.897027025789,76.5322499332095,84.5530290776138,150.572607316701,1252.56536444411
NA,"#008",2024-03-26,NA,NA,"Qiagen Dneasy PowerSoil ProKit Ref. 47014 Lot. 175032099",NA,"20240401-PNNL-NRB-Seq8",NA,"BLANK - Kit reagents",NA,NA,NA,NA,NA,NA,,0.0035,1.23,0.04,100,4,96,0.336,336,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0,0,0,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA
